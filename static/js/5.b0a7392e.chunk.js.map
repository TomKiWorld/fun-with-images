{"version":3,"sources":["containers/Register/Register.js"],"names":["Register","props","handleKeyUp","e","keyCode","document","querySelector","click","sanitize","string","map","replace","match","onFieldChange","event","term","setState","target","value","onSubmitRegister","preventDefault","state","name","email","password","validName","validEmail","validPassword","nameError","test","emailError","passwordError","fetch","DATABASE","method","headers","body","JSON","stringify","then","response","json","user","id","loadUser","registerError","onRouteChange","this","className","label","type","onChange","onKeyUp","onClick","extraClass","Component"],"mappings":"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","file":"static/js/5.b0a7392e.chunk.js","sourcesContent":["import React, { Component } from 'react';\nimport FormInput from '../../components/FormFields/FormInput/FormInput';\nimport FormSubmit from '../../components/FormFields/FormSubmit/FormSubmit';\nimport { DATABASE } from '../../constants';\n\n/**\n * Register component\n * - Allows a user to register to the app by displaying a form\n * \n * Required props:\n * - loadUser => Functon to get user information from state\n * - onRouteChange => Function to change the state of route\n */\nclass Register extends Component {\n  constructor(props) {\n    super();\n    this.state = {\n      name: '',\n      email: '',\n      password: '',\n      nameError: '',\n      emailError: '',\n      passwordError: '',\n      registerError: ''\n    }\n  }\n\n  // Allow pressing the enter key and not only the button\n  handleKeyUp = (e) => {\n    if (e.keyCode === 13) {\n      const register = document.querySelector('.register');\n      register.click();\n    }\n  }\n\n  // Sanitize user input\n  sanitize = (string) => {\n    const map = {\n        '&': '&amp;',\n        '<': '&lt;',\n        '>': '&gt;',\n        '\"': '&quot;',\n        \"'\": '&#x27;',\n        '/': '&#x2F;',\n    };\n    const reg = /[&<>\"'/]/ig;\n    return string.replace(reg, (match)=>(map[match]));\n  }\n\n  // Set state on input change\n  onFieldChange = (event, term) => {\n    this.setState({[term]: event.target.value })\n  }\n\n  // Validate user input and register the user\n  onSubmitRegister = (e) => {\n    e.preventDefault();\n    let {name, email, password } = this.state;\n    let validName = false;\n    let validEmail = false;\n    let validPassword = false;\n    const regexpEmail = /^\\w+([.-]?\\w+)*@\\w+([.-]?\\w+)*(\\.\\w{2,3})+$/;\n\n    if (name !== '' ) {\n      name = this.sanitize(name)\n      this.setState({name: name})\n      validName = true\n      this.setState({nameError: ''});\n    } else {\n      this.setState({nameError: 'Please enter your name'});\n    }\n\n    if ((email !== '') && (regexpEmail.test(email))) {\n      validEmail = true\n      this.setState({emailError: ''});\n    } else {\n      this.setState({emailError: 'Please enter your email'});\n    }\n\n    if (password !== '' ) {\n      validPassword = true\n      this.setState({passwordError: ''});\n    } else {\n      this.setState({passwordError: 'Please enter your password'});\n    }  \n\n    if ( validName && validEmail && validPassword ) {\n      fetch(`${DATABASE}/register`, {\n        method: 'post',\n        headers: {'Content-type': 'application/json'},\n        body: JSON.stringify({\n          name: name,\n          email: email,\n          password: password\n        })\n      })\n      .then(response => response.json())\n      .then(user => {\n        if (user.id) {\n          this.props.loadUser(user);\n          this.setState({registerError: ''});\n          this.props.onRouteChange('home');\n        } else {\n          this.setState({registerError: user});\n        }\n      })\n    } else {\n      this.setState({registerError: 'Something went wrong'});\n    }\n  }\n\n  render() {\n    const nameError = this.state.nameError ? <p className='error-message'>{this.state.nameError}</p> : '';\n    const emailError = this.state.emailError ? <p className='error-message'>{this.state.emailError}</p> : '';\n    const passwordError = this.state.passwordError ? <p className='error-message'>{this.state.passwordError}</p> : '';\n    const registerError = this.state.registerError ? <p className='error-message'>{this.state.registerError}</p> : '';\n\n    return (\n      <article className='register br3 ba dark-gray b--black-10 mv4 mw6 shadow-5 center'>\n        <form className='pa4 black-80'>\n          <div className='measure'>\n            <fieldset id='sign_up' className='ba b--transparent ph0 mh0'>\n              <h1 className='f1 fw6 ph0 mh0'>Register</h1>\n              <FormInput \n                label='Name'\n                name='name'\n                type='text'\n                onChange={(e) => this.onFieldChange(e, 'name')}\n                onKeyUp={this.handleKeyUp}\n              />\n              {nameError}\n              <FormInput \n                label='Email'\n                name='email-address'\n                type='email'\n                onChange={(e) => this.onFieldChange(e, 'email')}\n                onKeyUp={this.handleKeyUp}\n              />\n              {emailError}\n              <FormInput \n                label='Password'\n                name='password'\n                type='password'\n                onChange={(e) => this.onFieldChange(e, 'password')}\n                onKeyUp={this.handleKeyUp}\n              />\n              {passwordError}\n            </fieldset>\n            <FormSubmit\n              value='Register'\n              type='submit'\n              onClick={this.onSubmitRegister}\n              extraClass='register'\n            />\n            {registerError}\n          </div>\n        </form>        \n      </article>\n    );\n  }\n}\n\nexport default Register;\n"],"sourceRoot":""}