(this["webpackJsonpfun-with-images"]=this["webpackJsonpfun-with-images"]||[]).push([[5],{249:function(e,t,r){},250:function(e,t,r){},251:function(e,t,r){},258:function(e,t,r){"use strict";r.r(t);var n=r(8),a=r(9),o=r(11),s=r(10),c=r(0),i=r.n(c),l=r(33),u=r(1),m=r(18),p=function(e){var t=e.name,r=e.entries,n=r>0?"Welcome back":"Lets start";return i.a.createElement("section",{className:"container pa4"},i.a.createElement("div",{className:"white f3"},i.a.createElement("h1",null,n," ",i.a.createElement("span",{className:"capitalize"},t)),i.a.createElement("p",null,"Your current entry count is:")),i.a.createElement("div",{className:"white f1"},i.a.createElement("p",null,"#",r)))},g=(r(249),function(e){var t=e.onInputChange,r=e.onButtonSubmit,n=e.imageUrlError,a=e.getColorsError,o=e.getFacesError,s=e.inputValue;return i.a.createElement("main",null,i.a.createElement("p",{className:"f3 pa4"},"This App detects faces and colors in images"),i.a.createElement("div",{className:"center"},i.a.createElement("form",{className:"center form hyve pa4 shadow-5"},i.a.createElement("input",{className:"f4 pa2 w-70 center",value:s,type:"url",onChange:function(e){return t(e.target.value)}}),i.a.createElement("input",{value:"Detect",type:"submit",className:"detect w-30 grow link ph3 pv2 dib white bg-light-blue",onClick:r}))),n,a,o)}),f=(r(250),function(e){var t=e.colors,r=i.a.createElement("p",null,"No colors detected.");if(t.length){var n=t.map((function(e){var t=e.hex,r=e.name;return i.a.createElement("li",{key:t},i.a.createElement("span",{style:{backgroundColor:t}}),"HEX: ",t,", Name: ",r)}));r=i.a.createElement("ul",null,n)}return i.a.createElement("article",{className:"colors-list"},i.a.createElement("h2",null,"Detected colors:"),r)}),h=(r(251),function(e){var t=e.imageUrl,r=e.colors,n=t?i.a.createElement("img",{id:"imageElement",src:t,alt:"result"}):i.a.createElement("p",{className:"white"},"Submit an image url to start"),a=t?i.a.createElement(f,{colors:r}):"";return i.a.createElement("section",{className:"face-recognition container"},i.a.createElement("div",{className:"image-holder"},n),a)}),d=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(){var e;return Object(n.a)(this,r),(e=t.call(this)).onImageUrlSubmit=function(t){if(t&&t.preventDefault(),e.props.inputValue){e.props.inputValue!==e.props.imageUrl?/^(?:(?:https?|ftp):\/\/)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:\/\S*)?$/.test(e.props.inputValue)?(e.props.onImageChange(e.props.inputValue),e.props.onImageError(""),document.querySelectorAll(".bounding-box").forEach((function(e){return e.remove()})),e.getColors(),e.getFaces()):e.props.onImageError("Please enter a valid url"):e.props.onImageError("Please enter a new url")}else e.props.onImageError("Please enter an image url")},e.getColors=function(){fetch("".concat(u.c,"/image-colors"),{method:"post",headers:{"Content-type":"application/json",Authorization:window.sessionStorage.getItem("token")},body:JSON.stringify({input:e.props.inputValue})}).then((function(e){return e.json()})).then((function(t){if(!t||!t.outputs){var r=t||"No response from faces API";throw e.setState({getColorsError:r}),new Error(r)}e.setState({getColorsError:""}),fetch("".concat(u.c,"/image"),{method:"put",headers:{"Content-type":"application/json",Authorization:window.sessionStorage.getItem("token")},body:JSON.stringify({id:e.props.user.id,url:e.props.imageUrl})}).then((function(e){return e.json()})).then((function(t){e.props.onEntriesUpdate(e.props.user,t)})).catch((function(e){return console.log("getFaces colors: ",e)}));var n=[];t.outputs[0].data.colors.map((function(t){var r={hex:t.w3c.hex,name:t.w3c.name};return n.push(r),e.setState({colors:n})}))})).catch((function(e){return console.log(e)}))},e.getFaces=function(){fetch("".concat(u.c,"/image-faces"),{method:"post",headers:{"Content-type":"application/json",Authorization:window.sessionStorage.getItem("token")},body:JSON.stringify({input:e.props.inputValue})}).then((function(e){return e.json()})).then((function(t){if(!t||!t.outputs){var r=t||"No response from colors API";throw e.setState({getFacesError:r}),new Error(r)}e.setState({getFacesError:""}),e.calculateFaceLocations(t)})).catch((function(e){return console.log("getFaces error: ",e)}))},e.calculateFaceLocations=function(t){var r=document.getElementById("imageElement");if(r){var n=Number(r.width),a=Number(r.height),o=t.outputs[0].data.regions,s=[];o.map((function(t){return e.calculateBoundingBox(t,n,a,s)})),s.map((function(t){return e.displayBoundingBox(t,r)}))}},e.calculateBoundingBox=function(e,t,r,n){var a=e.region_info.bounding_box,o={leftCol:a.left_col*t,topRow:a.top_row*r,RightCol:t-a.right_col*t,bottomRow:r-a.bottom_row*r};n.push(o)},e.displayBoundingBox=function(e,t){var r=document.createElement("DIV");return r.classList.add("bounding-box"),r.style.left="".concat(e.leftCol.toFixed(4),"px"),r.style.top="".concat(e.topRow.toFixed(4),"px"),r.style.right="".concat(e.RightCol.toFixed(4),"px"),r.style.bottom="".concat(e.bottomRow.toFixed(4),"px"),t.parentElement.appendChild(r)},e.state={getColorsError:"",getFacesError:"",colors:[]},e}return Object(a.a)(r,[{key:"componentDidMount",value:function(){this.props.resubmit?(this.onImageUrlSubmit(),this.props.onResubmitImageUrl(!1)):(console.log(),this.props.onInputChange(""))}},{key:"render",value:function(){var e=this.props,t=e.user,r=e.imageUrlError,n=e.onInputChange,a=e.imageUrl,o=this.state.colors,s=r?i.a.createElement("p",{className:"error-message"},r):"",c=this.state.getColorsError?i.a.createElement("p",{className:"error-message"},this.state.getColorsError):"",l=this.state.getFacesError?i.a.createElement("p",{className:"error-message"},this.state.getFacesError):"";return i.a.createElement("article",{className:"mb4"},i.a.createElement(p,{name:t.name,entries:t.entries}),i.a.createElement(g,{inputValue:this.props.inputValue,imageUrlError:s,getColorsError:c,getFacesError:l,onInputChange:n,onButtonSubmit:this.onImageUrlSubmit}),i.a.createElement(h,{imageUrl:a,colors:o}))}}]),r}(c.Component);t.default=Object(l.b)((function(e){return{inputValue:e.imageUrlInputValue.inputValue,imageUrl:e.imageUrlInputValue.imageUrl,imageUrlError:e.imageUrlInputValue.imageUrlError,resubmit:e.imageUrlInputValue.resubmit,user:e.userInformation.user}}),(function(e){return{onInputChange:function(t){return e(Object(m.f)(t))},onImageChange:function(t){return e(Object(m.d)(t))},onImageError:function(t){return e(Object(m.e)(t))},onResubmitImageUrl:function(t){return e(Object(m.b)(t))},onEntriesUpdate:function(t,r){return e(Object(m.c)(t,r))}}}))(d)}}]);
//# sourceMappingURL=5.e1574ac4.chunk.js.map